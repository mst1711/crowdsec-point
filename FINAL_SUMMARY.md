# üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ Nginx + CrowdSec

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### üê≥ Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **docker-compose.yml** - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **docker-compose.prod.yml** - –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **.env.example** - –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### üåê Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **nginx/nginx.conf** - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **nginx/default.conf** - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **html/index.html** - —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### üõ°Ô∏è CrowdSec –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **crowdsec/config.yaml** - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CrowdSec
- **crowdsec/acquis.yaml** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ª–æ–≥–æ–≤
- **crowdsec/profiles.yaml** - –ø—Ä–æ—Ñ–∏–ª–∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ –∞–ª–µ—Ä—Ç—ã)
- **crowdsec/notifications/slack.yaml** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Slack
- **crowdsec/notifications/email.yaml** - email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **Makefile** - –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–º
- **test-security.sh** - —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **README.md** - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **QUICKSTART.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **DEPLOYMENT.md** - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- **PROJECT_STRUCTURE.md** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- **OVERVIEW.md** - –æ–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
git clone <repository>
cd nginx-crowdsec-security

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã
make start

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É
curl http://localhost:54104

# 4. –û—Ç–∫—Ä–æ–π—Ç–µ dashboard
# http://localhost:3000
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±
```bash
# –ë–µ–∑ Makefile
docker compose up -d
docker compose ps
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫
- **DDoS –∞—Ç–∞–∫–∏** - –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ë–æ—Ç—ã** - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ User-Agent –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—é
- **–ë—Ä—É—Ç—Ñ–æ—Ä—Å** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
- **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∫—Ä—ã—Ç—ã–º —Ñ–∞–π–ª–∞–º

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –Ω–∞ –ø–æ—Ä—Ç—É 3000 (Metabase)
- **–õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —á–µ—Ä–µ–∑ `make logs`
- **–ú–µ—Ç—Ä–∏–∫–∏** —á–µ—Ä–µ–∑ `make metrics`
- **–ê–ª–µ—Ä—Ç—ã** —á–µ—Ä–µ–∑ `make alerts`

### üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **Slack** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ webhook –≤ `crowdsec/notifications/slack.yaml`
- **Email** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SMTP –≤ `crowdsec/notifications/email.yaml`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
make test

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
./test-security.sh
```

### –†—É—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
# DDoS —Å–∏–º—É–ª—è—Ü–∏—è
for i in {1..50}; do curl -s http://localhost:54104/ > /dev/null; done

# –ë–æ—Ç —Å–∏–º—É–ª—è—Ü–∏—è
curl -H "User-Agent: sqlmap/1.0" http://localhost:54104/

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
curl http://localhost:54104/admin/
curl http://localhost:54104/.env
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–ª–µ—Ä—Ç–æ–≤
```bash
make alerts
# –∏–ª–∏
docker compose exec crowdsec cscli alerts list
```

### –ú–µ—Ç—Ä–∏–∫–∏
```bash
make metrics
# –∏–ª–∏
docker compose exec crowdsec cscli metrics
```

### –õ–æ–≥–∏
```bash
make logs
# –∏–ª–∏
docker compose logs -f
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### Slack
1. –°–æ–∑–¥–∞–π—Ç–µ Incoming Webhook –≤ Slack
2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `crowdsec/notifications/slack.yaml`
3. –£–∫–∞–∂–∏—Ç–µ URL webhook

### Email
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `crowdsec/notifications/email.yaml`
2. –£–∫–∞–∂–∏—Ç–µ SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. –î–æ–±–∞–≤—å—Ç–µ email –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

## üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ—Ä—Ç—ã

- **54104** - HTTP –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (nginx)
- **57885** - HTTPS –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (nginx, –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω SSL)
- **3000** - Dashboard –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Metabase)

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
make start          # –ó–∞–ø—É—Å–∫
make stop           # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make restart        # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
make status         # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
make logs           # –í—Å–µ –ª–æ–≥–∏
make logs-nginx     # –õ–æ–≥–∏ nginx
make logs-crowdsec  # –õ–æ–≥–∏ CrowdSec
make health         # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

# CrowdSec
make alerts         # –ê–ª–µ—Ä—Ç—ã
make metrics        # –ú–µ—Ç—Ä–∏–∫–∏
make decisions      # –†–µ—à–µ–Ω–∏—è
make collections    # –ö–æ–ª–ª–µ–∫—Ü–∏–∏

# –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
make backup         # –ë—ç–∫–∞–ø
make update         # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
make clean          # –û—á–∏—Å—Ç–∫–∞ (–û–°–¢–û–†–û–ñ–ù–û!)
```

## üîí –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

**–í–ê–ñ–ù–û**: –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ —Ä–µ–∂–∏–º–µ **–¢–û–õ–¨–ö–û –ê–õ–ï–†–¢–û–í**
- CrowdSec **–ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç** —Ç—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –í—Å–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è **—Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è** –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
nginx-crowdsec-security/
‚îú‚îÄ‚îÄ docker-compose.yml          # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docker-compose.prod.yml     # –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ .env.example                # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ Makefile                    # –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ test-security.sh            # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ nginx/                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf
‚îÇ   ‚îî‚îÄ‚îÄ default.conf
‚îú‚îÄ‚îÄ crowdsec/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CrowdSec
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml
‚îÇ   ‚îú‚îÄ‚îÄ acquis.yaml
‚îÇ   ‚îú‚îÄ‚îÄ profiles.yaml
‚îÇ   ‚îî‚îÄ‚îÄ notifications/
‚îÇ       ‚îú‚îÄ‚îÄ slack.yaml
‚îÇ       ‚îî‚îÄ‚îÄ email.yaml
‚îú‚îÄ‚îÄ html/                       # –í–µ–±-–∫–æ–Ω—Ç–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îî‚îÄ‚îÄ docs/                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ README.md
    ‚îú‚îÄ‚îÄ QUICKSTART.md
    ‚îú‚îÄ‚îÄ DEPLOYMENT.md
    ‚îú‚îÄ‚îÄ PROJECT_STRUCTURE.md
    ‚îî‚îÄ‚îÄ OVERVIEW.md
```

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ. –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `make start` –∏ –Ω–∞—á–∏–Ω–∞–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞!

---

**–°–æ–∑–¥–∞–Ω–æ**: 2025-06-04  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É